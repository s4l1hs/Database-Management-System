{% extends "base.html" %}

{% block title %}Greenhouse Gas Emissions{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h1 class="h3 mb-1">Greenhouse Gas Emissions</h1>
    <p class="text-muted mb-0">
      Country-based greenhouse gas emission indicators with year and source notes.
    </p>
  </div>

  {# Sadece adminler Add butonunu görsün #}
  {% if session.get("team_no")|int == 1 %}

    <a href="{{ url_for('ghg.add_ghg') }}" class="btn btn-primary">
      <i class="fa-solid fa-plus"></i> Add New Record
    </a>
  {% endif %}
</div>

<table class="table table-striped table-hover align-middle">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>Country</th>
      <th>Region</th>
      <th>Code</th>
      <th>Indicator</th>
      <th>Unit</th>
      <th>Year</th>
      <th>Value</th>
      <th>Share of Total (%)</th>
      <th>Uncertainty (%)</th>
      <th>Source Notes</th>
      {% if session.get("team_no")|int == 1 %}

        <th>Actions</th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for ghg, country, indicator in rows %}
      <tr>
        <td>{{ ghg.row_id }}</td>
        <td>{{ country.country_name }}</td>
        <td>{{ country.region or '-' }}</td>
        <td>{{ country.country_code }}</td>
        <td>{{ indicator.indicator_name }}</td>
        <td>{{ indicator.unit_symbol or '-' }}</td>
        <td>{{ ghg.year }}</td>
        <td>{{ ghg.indicator_value }}</td>
        <td>{{ ghg.share_of_total_pct or '-' }}</td>
        <td>{{ ghg.uncertainty_pct or '-' }}</td>
        <td>{{ ghg.source_notes or '' }}</td>

        {% if session.get("team_no")|int == 1 %}

          <td>
            <a
              href="{{ url_for('ghg.edit_ghg', id=ghg.row_id) }}"
              class="btn btn-sm btn-outline-secondary me-1"
            >
              Edit
            </a>
            <form
              action="{{ url_for('ghg.delete_ghg', id=ghg.row_id) }}"
              method="post"
              style="display:inline-block"
              onsubmit="return confirm('Delete this record?');"
            >
              <button type="submit" class="btn btn-sm btn-outline-danger">
                Delete
              </button>
            </form>
          </td>
        {% endif %}
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}

